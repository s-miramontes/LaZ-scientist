1 Introduction. An inherent problem for statistical methods in natural language processing is that of sparse data — the inaccurate representation in any training corpus of the probability of low frequency events. In particular, reasonable events that happen to not occur in the training set may mistakenly be assigned a probability of zero. These unseen events generally make up a substantial portion of novel data; for example, Essen and Steinbiss (1992) report that 12% of the test-set bigrams in a 75%-25% split of one million words did not occur in the training partition. We consider here the question of how to estimate the conditional cooccurrence probability P(v In) of an unseen word pair (n, v) drawn from some finite set N x V. Two state-of-the-art technologies are Katz's (1987) backoff method and Jelinek and Mercer's (1980) interpolation method. Both use P(v) to estimate P(v In) when (n, v) is unseen, essentially ignoring the identity of n. An alternative approach is distance-weighted averaging, which arrives at an estimate for unseen cooccurrences by combining estimates for where S(n) is a set of candidate similar words and sim(n, m) is a function of the similarity between n and m. We focus on distributional rather than semantic similarity (e.g., Resnik (1995)) because the goal of distance-weighted averaging is to smooth probability distributions — although the words &quot;chance&quot; and &quot;probability&quot; are synonyms, the former may not be a good model for predicting what cooccurrences the latter is likely to participate in. There are many plausible measures of distributional similarity. In previous work (Dagan et al., 1999), we compared the performance of three different functions: the Jensen-Shannon divergence (total divergence to the average), the L1 norm, and the confusion probability. Our experiments on a frequency-controlled pseudoword disambiguation task showed that using any of the three in a distance-weighted averaging scheme yielded large improvements over Katz's backoff smoothing method in predicting unseen coocurrences. Furthermore, by using a restricted version of model (1) that stripped incomparable parameters, we were able to empirically demonstrate that the confusion probability is fundamentally worse at selecting useful similar words. D. Lin also found that the choice of similarity function can affect the quality of automatically-constructed thesauri to a statistically significant degree (1998a) and the ability to determine common morphological roots by as much as 49% in precision (1998b). 3-The term &quot;similarity-based&quot;, which we have used previously, has been applied to describe other models as well (L. Lee, 1997; Karov and Edelman, 1998). These empirical results indicate that investigating different similarity measures can lead to improved natural language processing. On the other hand, while there have been many similarity measures proposed and analyzed in the information retrieval literature (Jones and Furnas, 1987), there has been some doubt expressed in that community that the choice of similarity metric has any practical impact: Several authors have pointed out that the difference in retrieval performance achieved by different measures of association is insignificant, providing that these are appropriately normalised. (van Rijsbergen, 1979, pg. 38) But no contradiction arises because, as van Rijsbergen continues, &quot;one would expect this since most measures incorporate the same information&quot;. In the language-modeling domain, there is currently no agreed-upon best similarity metric because there is no agreement on what the &quot;same information&quot; — the key data that a similarity function should incorporate — is. The overall goal of the work described here was to discover these key characteristics. To this end, we first compared a number of common similarity measures, evaluating them in a parameter-free way on a decision task. When grouped by average performance, they fell into several coherent classes, which corresponded to the extent to which the functions focused on the intersection of the supports (regions of positive probability) of the distributions. Using this insight, we developed an information-theoretic metric, the skew divergence, which incorporates the support-intersection data in an asymmetric fashion. This function yielded the best performance overall: an average error rate reduction of 4% (significant at the .01 level) with respect to the Jensen-Shannon divergence, the best predictor of unseen events in our earlier experiments (Dagan et al., 1999). Our contributions are thus three-fold: an empirical comparison of a broad range of similarity metrics using an evaluation methodology that factors out inessential degrees of freedom; a proposal, building on this comparison, of a characteristic for classifying similarity functions; and the introduction of a new similarity metric incorporating this characteristic that is superior at evaluating potential proxy distributions.
2 Distributional Similarity Functions. In this section, we describe the seven distributional similarity functions we initally evaluated.2 For concreteness, we choose N and V to be the set of nouns and the set of transitive verbs, respectively; a cooccurrence pair (n, v) results when n appears as the head noun of the direct object of v. We use P to denote probabilities assigned by a base language model (in our experiments, we simply used unsmoothed relative frequencies derived from training corpus counts). Let n and m be two nouns whose distributional similarity is to be determined; for notational simplicity, we write q(v) for P(v In) and r (v) for P(v1m), their respective conditional verb cooccurrence probabilities. Figure 1 lists several familiar functions. The cosine metric and Jaccard's coefficient are commonly used in information retrieval as measures of association (Salton and McGill, 1983). Note that Jaccard's coefficient differs from all the other measures we consider in that it is essentially combinatorial, being based only on the sizes of the supports of q, r, and q • r rather than the actual values of the distributions. Previously, we found the Jensen-Shannon divergence (Rao, 1982; J. Lin, 1991) to be a useful measure of the distance between distributions: The function D is the KL divergence, which measures the (always nonnegative) average inefficiency in using one distribution to code for another (Cover and Thomas, 1991): The function avgq denotes the average distribution avgq,r(v) = (q(v) + r(v))/2; observe that its use ensures that the Jensen-Shannon divergence is always defined. In contrast, D(q1 Ir) is undefined if q is not absolutely continuous with respect to r (i.e., the support of q is not a subset of the support of r). 2Strictly speaking, some of these functions are dissimilarity measures, but each such function f can be recast as a similarity function via the simple transformation C — f, where C is an appropriate constant. Whether we mean f or C — f should be clear from context. 1, The confusion probability has been used by several authors to smooth word cooccurrence probabilities (Sugawara et al., 1985; Essen and Steinbiss, 1992; Grishman and Sterling, 1993); it measures the degree to which word m can be substituted into the contexts in which n appears. If the base language model probabilities obey certain Bayesian consistency conditions (Dagan et al., 1999), as is the case for relative frequencies, then we may write the confusion probability as follows: Note that it incorporates unigram probabilities as well as the two distributions q and r. Finally, Kendall's T which appears in work on clustering similar adjectives (Hatzivassiloglou and McKeown, 1993; Hatzivassiloglou, 1996), is a nonparametric measure of the association between random variables (Gibbons, 1993). In our context, it looks for correlation between the behavior of q and r on pairs of verbs. Three versions exist; we use the simplest, Ta, here: sign [(q(vi) — q(v2))(r(vi) — r(v2)) 2(11;1) where sign(x) is 1 for positive arguments, —1 for negative arguments, and 0 at 0. The intuition behind Kendall's T is as follows. Assume all verbs have distinct conditional probabilities. If sorting the verbs by the likelihoods assigned by q yields exactly the same ordering as that which results from ranking them according to r, then T (q, r) = 1; if it yields exactly the opposite ordering, then T(q,r) = —1. We treat a value of —1 as indicating extreme dissimilarity.3 It is worth noting at this point that there are several well-known measures from the NLP literature that we have omitted from our experiments. Arguably the most widely used is the mutual information (Hindle, 1990; Church and Hanks, 1990; Dagan et al., 1995; Luk, 1995; D. Lin, 1998a). It does not apply in the present setting because it does not measure the similarity between two arbitrary probability distributions (in our case, P(Vin) and P(V1m)), but rather the similarity between a joint distribution P(Xi, X2) and the corresponding product distribution P(Xi)P(X2)• Hamming-type metrics (Cardie, 1993; Zavrel and Daelemans, 1997) are intended for data with symbolic features, since they count feature label mismatches, whereas we are dealing feature values that are probabilities. Variations of the value difference metric (Stanfill and Waltz, 1986) have been employed for supervised disambiguation (Ng and H.B. Lee, 1996; Ng, 1997); but it is not reasonable in language modeling to expect training data tagged with correct probabilities. The Dice coefficient (Smadja et al., 1996; D. Lin, 1998a, 1998b) is monotonic in Jaccard's coefficient (van Rijsbergen, 1979), so its inclusion in our experiments would be redundant. Finally, we did not use the KL divergence because it requires a smoothed base language model.
3 Empirical Comparison. We evaluated the similarity functions introduced in the previous section on a binary decision task, using the same experimental framework as in our previous preliminary comparison (Dagan et al., 1999). That is, the data consisted of the verb-object cooccurrence pairs in the 1988 Associated Press newswire involving the 1000 most frequent nouns, extracted via Church's (1988) and Yarowsky's processing tools. 587,833 (80%) of the pairs served as a training set from which to calculate base probabilities. From the other 20%, we prepared test sets as follows: after discarding pairs occurring in the training data (after all, the point of similarity-based estimation is to deal with unseen pairs), we split the remaining pairs into five partitions, and replaced each nounverb pair (n, v1) with a noun-verb-verb triple (n, vi, v2) such that P(v2) P(vi). The task for the language model under evaluation was to reconstruct which of (n, vi) and (n, v2) was the original cooccurrence. Note that by construction, (n, vi) was always the correct answer, and furthermore, methods relying solely on unigram frequencies would perform no better than chance. Test-set performance was measured by the error rate, defined as —1(# of incorrect choices + (# of ties)/2) , where T is the number of test triple tokens in the set, and a tie results when both alternatives are deemed equally likely by the language model in question. To perform the evaluation, we incorporated each similarity function into a decision rule as follows. For a given similarity measure f and neighborhood size k, let Sf,k(n) denote the k most similar words to n according to f. We define the evidence according to f for the cooccurrence (n, vi) as Then, the decision rule was to choose the alternative with the greatest evidence. The reason we used a restricted version of the distance-weighted averaging model was that we sought to discover fundamental differences in behavior. Because we have a binary decision task, Ef,k(n, vi) simply counts the number of k nearest neighbors to n that make the right decision. If we have two functions f and g such that Ef,k(n,vi) > Eg,k(n, v1), then the k most similar words according to f are on the whole better predictors than the k most similar words according to g; hence, f induces an inherently better similarity ranking for distance-weighted averaging. The difficulty with using the full model (Equation (1)) for comparison purposes is that fundamental differences can be obscured by issues of weighting. For example, suppose the probability estimate E (2 — Li (q,r)) • r(v) (suitably normalized) performed poorly. We would not be able to tell whether the cause was an inherent deficiency in the L1 norm or just a poor choice of weight function — perhaps (2 — Li (q, r))2 would have yielded better estimates. Figure 2 shows how the average error rate varies with k for the seven similarity metrics introduced above. As previously mentioned, a steeper slope indicates a better similarity ranking. All the curves have a generally upward trend but always lie far below backoff (51% error rate). They meet at k = 1000 because Sf JD:x:1(n) is always the set of all nouns. We see that the functions fall into four groups: (1) the L2 norm; (2) Kendall's T; (3) the confusion probability and the cosine metric; and (4) the L1 norm, Jensen-Shannon divergence, and Jaccard's coefficient. We can account for the similar performance of various metrics by analyzing how they incorporate information from the intersection of the supports of q and r. (Recall that we are using q and r for the conditional verb cooccurrrence probabilities of two nouns n and m.) Consider the following supports (illustrated in Figure 3): We can rewrite the similarity functions from Section 2 in terms of these sets, making use of the identities E vEVqWqr q(v) + EvEVqr q(V) = EvEvrwqr r(v) + EvEVqr r(v) = 1. Table 1 lists these alternative forms in order of performance. We see that for the non-combinatorial functions, the groups correspond to the degree to which the measures rely on the verbs in Vqr. The Jensen-Shannon divergence and the L1 norm can be computed simply by knowing the values of q and r on Vqr. For the cosine and the confusion probability, the distribution values on Vqr are key, but other information is also incorporated. The statistic Ta takes into account all verbs, including those that occur neither with The superior performance of Jac(q, r) seems to underscore the importance of the set Vqr. Jaccard's coefficient ignores the values of q and r on Vqr; but we see that simply knowing the size of Vqr relative to the supports of q and r leads to good rankings. 4 The Skew Divergence Based on the results just described, it appears that it is desirable to have a similarity function that focuses on the verbs that cooccur with both of the nouns being compared. However, we can make a further observation: with the exception of the confusion probability, all the functions we compared are symmetric, that is, f (q, r) = f (r, q). But the substitutability of one word for another need not symmetric. For instance, &quot;fruit&quot; may be the best possible approximation to &quot;apple&quot;, but the distribution of &quot;apple&quot; may not be a suitable proxy for the distribution of &quot;fruit&quot; .4 In accordance with this insight, we developed a novel asymmetric generalization of the KL divergence, the a-skew divergence: scr(q,r) = D (r Ia.q+(1 —a) r) for 0 < a < 1. It can easily be shown that sc, depends only on the verbs in Vqr. Note that at a = 1, the skew divergence is exactly the KL divergence, and s1/2 is twice one of the summands of JS (note that it is still asymmetric). 40n a related note, an anonymous reviewer cited the 30 following example from the psychology literature: we can say Smith's lecture is like a sleeping pill, but &quot;not the other way round&quot;. average error rate Error rates (averages and ranges) definition of commonality is left to the user (several different definitions are proposed for different tasks). We view the empirical approach taken in this paper as complementary to Lin's. That is, we are working in the context of a particular application, and, while we have no mathematical certainty of the importance of the &quot;common support&quot; information, we did not assume it a priori; rather, we let the performance data guide our thinking. Finally, we observe that the skew metric seems quite promising. We conjecture that appropriate values for a may inversely correspond to the degree of sparseness in the data, and intend in the future to test this conjecture on larger-scale prediction tasks. We also plan to evaluate skewed versions of the Jensen-Shannon divergence proposed by Rao (1982) and J. Lin (1991).
6 Acknowledgements. Thanks to Claire Cardie, Jon Kleinberg, Fernando Pereira, and Stuart Shieber for helpful discussions, the anonymous reviewers for their insightful comments, Fernando Pereira for access to computational resources at AT&T, and Stuart Shieber for the opportunity to pursue this work at Harvard University under NSF Grant No. IRI9712068.